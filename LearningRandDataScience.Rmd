---
title: "Learning R and Data Science"
author: "Yao-Jen Kuo"
date: "Saturday, March 12, 2016"
output: slidy_presentation
---

## 簡單自我介紹

- yaojenkuo.github.com
- tonykuoyj@gmail.com

## 系統訓練班

- 門禁卡收200元押金
- 今天上完課就得決定是否退費
- 開車的同學記得找講師蓋停車章可以半價優惠
- 加入社團跟同學認識、交流
    - https://www.facebook.com/groups/CSIETrainRL1263/

## 對資料科學的淺見

- 把問題定義清楚
- 找資料(專題一)
- 整理資料(專題一)
- 視覺化探勘(專題二)
- 建模型(專題三)
- 視覺化呈現(專題二)

## 開卷有益

- [R in Action](https://www.manning.com/books/r-in-action-second-edition)

![R in Action](image/rInAction.jpg)

- [The Art of R Programming](http://www.amazon.com/The-Art-Programming-Statistical-Software/dp/1593273843)

![The Art of R Programming](image/The-Art-of-R-Programming-Matloff-Norman.jpg)

## 其他學習管道

- swirl套件
- Coursera
- Data Camp
- R-blogger
- GitHub
- Stackoverflow

![這我最會](image/stackoverflowfunny.jpg)

## 大眾臉

- 其實R語言長得跟大部分的程式語言蠻像的
- 跟C, C++, Java, VB, C#, Ruby, Python, JavaScript...等語法差不多

## 大眾臉是什麼意思

- if
- for
- while
- function
- ...

## 學R語言的幾個重點

- 安裝**開發環境**
- 如何宣告變數
- 如何寫if
- 如何寫迴圈
- 如何存取不同data type中的元素
- 如何使用function
- 如何宣告function

## 安裝開發環境

- R Console
- RStudio
- https://github.com/yaojenkuo/RGettingStarted/blob/master/R_Installation.md

## 如何宣告變數

- 用`<-`指定
- 或用`=`指定
- `==`用來作邏輯運算子**等於**

```{r}
firstVariable <- 'Hello World!'
print(firstVariable)

secondVariable = 2
print(secondVariable)
```

## 如何寫if

```{r}
revenueCalculator <- function(unitCost=50, unit){
    revenue <- unitCost * unit
    if(unit > 100) {
      revenue <- revenue * 0.8
    }
    return(revenue)
}
revenueCalculator(unit=99)
revenueCalculator(unit=101)
```

## 如何寫迴圈

```{r}
vector <- seq(1, 10)
for (index in vector){
  print(index)
}
```

## 如何存取不同data type中的元素

```{r}
vector1 <- seq(1, 9)
vector1[1]

matrix <- matrix(vector1, nrow=3)
matrix[2,3]

vector2 <- seq(10, 18)
dataFrame <- data.frame(vector1, vector2)
dataFrame[, 2]
dataFrame[2, ]
```

## 如何使用function

```{r}
summary(cars)
library(magrittr)
cars %>% summary()
```

## 如何宣告function

```{r}
revenueCalculator <- function(unitCost=50, unit){
    revenue <- unitCost * unit
    if(unit > 100) {
      revenue <- revenue * 0.8
    }
    return(revenue)
}
revenueCalculator(unit=99)
revenueCalculator(unit=101)
```

## 除了語法基本功以外

- R語言的強項是什麼
- R語言可以做哪些事

## R語言強項有

- 

## R語言可以做哪些事

- 蒐集資料
    - 從檔案
    - 從網路
- 整理資料
- 視覺化
- 建模型
- 做Presentation

## 從檔案蒐集資料

```{r}
dataCollection1 <- function(language, path, rowsPrint){
  Sys.setlocale(category="LC_ALL", locale=language)
  data <- read.csv(path, stringsAsFactors=FALSE)
  data <<- read.csv(path, stringsAsFactors=FALSE)
  headRows <- head(data, rowsPrint)
  return (headRows)
}
dataCollection1(language="cht", path="C:/NTUTrainRL1/data/funCoastAccident.csv", rowsPrint=10)

#Sys.setlocale(category = "LC_ALL", locale = "cht")
#data <- read.csv("C:/NTUTrainRL1/data/funCoastAccident.csv", stringsAsFactors=FALSE)
#head(data, 10)
```

## 從網路蒐集資料

```{r}
# Necessary libraries for a web parser
neccessaryLibs <- function(libVectors){
  packages <- libVectors
  for (index in 1:length(packages)){
    install.packages(packages[index])
  }
  sapply(packages, library, character.only = TRUE)
}

# yahooRankParser
yahooRankParser <- function(URL, xpathRank, xpathStock, xpathPrice){
  doc <- read_html(URL)
  #columns <- c(xpathRank, xpathStock, xpathPrice)
  rank <- doc %>% 
    html_nodes(.,xpath = xpathRank) %>%
    html_text
  stock <- doc %>% 
    html_nodes(.,xpath = xpathStock) %>%
    html_text %>%
    iconv(from = "UTF-8", to = "UTF-8")
  price <- doc %>% 
    html_nodes(.,xpath = xpathPrice) %>%
    html_text
  stockDF <<- data.frame(rank=as.integer(rank), stock=stock, price=as.numeric(price))# return to global environment
}

# Declaring function parameters
libVectors <- c("magrittr", "rvest")
URL <- "https://tw.stock.yahoo.com/d/i/rank.php?t=pri&e=tse"
xpathRank <- "//table[2]/tbody/tr/td[1]"
xpathStock <- "//tbody/tr/td[@class='name']"
xpathPrice <- "//table[2]/tbody/tr/td[3]"

# Executing functions
neccessaryLibs(libVectors)
yahooRankParser(URL, xpathRank, xpathStock, xpathPrice)
head(stockDF)
```

## 整理資料

```{r}
str(stockDF)

# Split stock code and name then combine back to original data frame
stockDFSplit <- function(){
  stock <- as.character(stockDF[, "stock"])
  stockCD <- substr(stock, 1, 4)
  stockName <- substr(stock, 6, nchar(stock))
  stockRank <- stockDF[, "rank"]
  stockPrice <- stockDF[, "price"]
  stockDFSplit <<- data.frame(rank=stockRank, name=stockName, price=stockPrice, code=stockCD)
  return(stockDFSplit)
}
stockDFSplit()
```

## 視覺化

```{r}
library(plotly)

plotly

```

## 建模型

## 做Presentation

## 講義

- [新手上路](https://github.com/yaojenkuo/RGettingStarted)
- [R語言玩資料](https://github.com/yaojenkuo/NTUTrainRL1)